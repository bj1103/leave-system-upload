<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>役男管理系統</title>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- 功能選單 -->
    <div class="tab-menu">
        <button class="tab-button active" onclick="switchTab('leave')">發放夜假</button>
        <button class="tab-button" onclick="switchTab('manage')">新增與刪除役男</button>
        <button class="tab-button" onclick="switchTab('records')">查看役男夜假</button>
        <button class="tab-button" onclick="switchTab('absences')">修改役男請假紀錄</button>
        <button class="tab-button" onclick="switchTab('manual')">使用教學</button>
    </div>

    <!-- 發放夜假區塊 -->
    <div id="leave" class="tab-content active">
        <h2>發放夜假</h2>
        <h3>上傳夜假</h3>
        <p>Excel欄位: 梯次  姓名  單位  原因  核發與否</p>
        <input type="file" id="fileInput">
        <button onclick="uploadFile()">上傳</button>

        <h3>Excel 內容</h3>
        <table border="1" id="dataTable"></table>
        <button id="importButton" onclick="importData()" style="display: none;">匯入系統</button>

    </div>

    <!-- 新增與刪除役男區塊 -->
    <div id="manage" class="tab-content">
        <h2>新增與刪除役男</h2>

        <!-- 新增役男 -->
        <h3>新增役男</h3>
        <label>姓名：<input type="text" id="add_name"></label>
        <label>梯次：<input type="text" id="add_batch"></label>
        <label>單位：<input type="text" id="add_unit"></label>
        <button onclick="confirmAddUser()">新增</button>

        <!-- 刪除役男 -->
        <h3>刪除役男</h3>
        <label for="deleteUser">選擇役男：</label>
        <select id="deleteUser"></select>
        <button onclick="confirmDeleteUser()">刪除</button>
    </div>

    <!-- 查看夜假區塊 -->
    <div id="records" class="tab-content">
        <h2>查看役男夜假</h2>
        <label for="leaveRecords">選擇役男：</label>
        <select id="leaveRecords"></select>
        <button onclick="fetchLeaveRecords()">查詢</button>
        <table border="1">
            <thead>
                <tr>
                    <th>核發原因</th>
                    <th>核發日期</th>
                    <th>有效期限</th>
                    <th>使用日期</th>
                </tr>
            </thead>
            <tbody id="recordsTableBody"></tbody>
        </table>
    </div>

    <!-- 查看請假紀錄區塊 -->
    <div id="absences" class="tab-content">
        <h2>修改役男請假紀錄</h2>
        <label for="absenceRecords">選擇役男：</label>
        <select id="absenceRecords"></select>
        <button onclick="fetchAbsenceRecords()">查詢</button>
        <h3>刪除請假紀錄</h3>
        <table border="1">
            <thead>
                <tr>
                    <th>日期</th>
                    <th>假別</th>
                    <th>操作</th> <!-- 新增刪除按鈕 -->
                </tr>
            </thead>
            <tbody id="absencesTableBody"></tbody>
        </table>

        <!-- 新增請假紀錄區塊 -->
        <h3>新增請假紀錄</h3>
        <label>日期：<input type="date" id="new_issue_date"></label>
        <label>假別：
            <select id="new_reason">
                <option value="夜假">夜假</option>
                <option value="隔天補休">隔天補休</option>
                <option value="公差">公差</option>
                <option value="其他">其他</option>
            </select>
        </label>
        <button onclick="addAbsenceRecord()">新增</button>
    </div>


    <div id="manual" class="tab-content">
        <h2>使用教學</h2>
        <p>（此處可加入使用教學）</p>
    </div>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
